# Project PM — Design Document

**Date**: 2026-02-15
**Status**: Approved

## Problem

Managing 50+ projects across GitHub with no centralized view of what's active, what's abandoned, where you left off, or whether multiple projects duplicate the same functionality. CLAUDE.md files exist in some projects but there's no tool that aggregates them into an actionable overview.

## Solution

A monolith Next.js application ("Project PM") that combines:

1. **A CLI scanner** that gathers project metadata from GitHub API and local filesystem
2. **A web dashboard** for visual overview, filtering, drill-down, and overlap detection
3. **A manual override system** for tagging, noting, and pausing projects

## Architecture: Monolith App

Single Next.js repo containing the scanner CLI, data layer, and dashboard UI. No database — JSON files on disk.

### Why monolith?

- Scanner and dashboard share TypeScript types
- One repo, one `package.json`, one deploy
- `npm run scan && npm run dev` to refresh and view
- YAGNI on splitting until there's a reason to

## Data Model

### Manifest (`data/manifest.json`)

Generated by the scanner. Source of truth for the dashboard.

```typescript
interface ProjectManifest {
  generatedAt: string;
  projects: Project[];
}

interface Project {
  // Identity
  name: string;
  path: string | null;
  githubUrl: string | null;

  // Status signals (git)
  lastCommitDate: string | null;
  commitCountLast30Days: number;
  openPRCount: number;
  defaultBranch: string;
  branchCount: number;

  // Status signals (docs)
  hasClaude: boolean;
  hasReadme: boolean;
  hasPlanDocs: boolean;
  hasTodos: boolean;

  // Extracted metadata
  description: string | null;
  techStack: string[];
  capabilities: string[];

  // Manual overrides
  tags: string[];
  status: ProjectStatus | null;
  notes: string | null;

  // Computed
  computedStatus: ProjectStatus;
}

type ProjectStatus = 'active' | 'recent' | 'stale' | 'abandoned' | 'paused';
```

### Overrides (`data/overrides.json`)

User-edited file for manual tags, notes, and status overrides. Never overwritten by the scanner. Merged at read time.

```typescript
interface Overrides {
  [projectName: string]: {
    tags?: string[];
    status?: ProjectStatus;
    notes?: string;
  };
}
```

## Scanner

### Flow

1. Call GitHub API (via Octokit) to list all repos for configured user/org
2. For each repo: fetch last commit date, PR count, branch count, default branch
3. For locally cloned repos: read CLAUDE.md, README, scan for plan docs and TODOs
4. Extract description, capabilities, and tech stack from docs
5. Merge with existing manual overrides from `overrides.json`
6. Compute status for each project
7. Write `manifest.json`

### Status Algorithm

| Status    | Criteria                        |
|-----------|---------------------------------|
| Active    | Commits in last 7 days          |
| Recent    | Commits in last 30 days         |
| Stale     | Commits in last 90 days         |
| Abandoned | No commits in 90+ days          |
| Paused    | Manual override only             |

Manual `status` in overrides takes precedence over computed status.

### Capability Extraction

Parses CLAUDE.md and README files using heuristics:

- **Description**: First non-heading, non-empty paragraph
- **Tech stack**: Detected from `package.json` dependencies, file extensions, and doc mentions
- **Capabilities**: Keywords from markdown headers and bullets, normalized via a controlled vocabulary map

#### Controlled Vocabulary

Maps common terms to canonical capabilities:

```typescript
const CAPABILITY_MAP: Record<string, string> = {
  'email': 'email-sending',
  'smtp': 'email-sending',
  'ses': 'email-sending',
  'sendgrid': 'email-sending',
  'auth': 'authentication',
  'login': 'authentication',
  'oauth': 'authentication',
  'jwt': 'authentication',
  's3': 'file-storage',
  'upload': 'file-storage',
  'api': 'api-server',
  'express': 'api-server',
  'fastify': 'api-server',
  // extensible
};
```

Powers the overlap detector: when multiple projects map to the same canonical capability, they surface as potential duplicates.

#### Projects without CLAUDE.md

Still tracked via git signals, file-extension-based tech stack detection, and dependency-based capability inference (e.g., `@aws-sdk/client-ses` in `package.json` maps to `email-sending`).

## Dashboard

### Tech Stack

- Next.js (App Router) + Tailwind CSS
- Server components read manifest from disk
- Client components for filtering, sorting, interactions

### Views

#### 1. Overview (default route `/`)

- **Summary cards**: total projects, active, recent, stale, abandoned counts
- **Project table**: sortable/filterable — columns: name, status badge, last commit, description snippet, tech stack tags, capability tags
- **Filters**: status, tech stack, tags, has CLAUDE.md

#### 2. Project Detail (`/projects/[name]`)

- Full description and all metadata
- Links to GitHub repo
- Planning docs summary: plan files, TODOs found
- "Where I left off": last commit message, open branches, open PRs
- Manual override controls: set status, add tags, write notes

#### 3. Overlap Detector (`/overlaps`)

- Projects grouped by shared capabilities
- Highlights where 2+ projects share the same canonical capability
- Keyword-based grouping in v1 (AI enrichment in future)

### Interactions

- **Scan button**: triggers scanner, refreshes manifest, reloads dashboard
- **Tag/note editing**: writes to `overrides.json`, persists across scans
- **Export**: download manifest as JSON or summary as markdown

## Project Structure

```
project-pm/
├── package.json
├── tsconfig.json
├── next.config.js
├── .env.local                  # GITHUB_TOKEN
│
├── scanner/
│   ├── index.ts                # CLI entry point
│   ├── github.ts               # GitHub API client
│   ├── local.ts                # Local filesystem reader
│   ├── extractor.ts            # Doc parsing → description, capabilities, tech stack
│   ├── status.ts               # Status computation algorithm
│   └── types.ts                # Shared TypeScript interfaces
│
├── data/
│   ├── manifest.json           # Generated by scanner (gitignored)
│   └── overrides.json          # Manual overrides (committed)
│
├── src/app/
│   ├── layout.tsx
│   ├── page.tsx                # Overview
│   ├── projects/[name]/
│   │   └── page.tsx            # Project detail
│   └── overlaps/
│       └── page.tsx            # Overlap detector
│
├── src/components/
│   ├── ProjectTable.tsx
│   ├── StatusBadge.tsx
│   ├── FilterBar.tsx
│   ├── SummaryCards.tsx
│   ├── OverlapGrid.tsx
│   └── ProjectDetail.tsx
│
└── src/lib/
    ├── manifest.ts             # Read/parse manifest
    └── overlaps.ts             # Capability grouping logic
```

## Out of Scope for v1

- AI-powered similarity detection (future: Claude API for semantic comparison)
- GitHub Actions automation for scheduled scans
- Dashboard authentication (local use only)
- Webhook/real-time updates
- Multi-user support
